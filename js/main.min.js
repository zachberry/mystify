var INTERVAL_TIME=42,NUM_TRAILS=14,NUM_POINTS=4,NUM_POLYGONS=2,SATURATION=100,BRIGHTNESS=50,COLOR_TWEEN_INTERVAL=3,COLOR_HUE_INCREMENT=1,canvas,context,curPointListIndex=0,pointLists=[],numSteps=0,intervalID=-1,renderStep,polygonsList=[],canvasWidth,canvasHeight;$(document).ready(init);function toggleAbout(){resizeWindows();$("#about").toggle()}function toggleSettings(){createSliders();$("#settings").toggle()}
function createSliders(){if($("#slider-redraw").html()==""){$("#slider-redraw").slider({value:300-INTERVAL_TIME,min:0,max:300,step:10,slide:function(a,b){INTERVAL_TIME=300-b.value;initInterval();updateSettingsLabels()}});$("#slider-shapes").slider({value:NUM_POLYGONS,min:1,max:20,step:1,slide:function(a,b){NUM_POLYGONS=b.value;start();updateSettingsLabels()}});$("#slider-trails").slider({value:NUM_TRAILS,min:0,max:100,step:1,slide:function(a,b){NUM_TRAILS=b.value;start();updateSettingsLabels()}});
$("#slider-lines").slider({value:NUM_POINTS,min:3,max:50,step:1,slide:function(a,b){NUM_POINTS=b.value;start();updateSettingsLabels()}});$("#slider-sat").slider({value:SATURATION,min:0,max:100,step:10,slide:function(a,b){SATURATION=b.value;updateColor();updateSettingsLabels()}});$("#slider-bright").slider({value:BRIGHTNESS,min:0,max:100,step:10,slide:function(a,b){BRIGHTNESS=b.value;updateColor();updateSettingsLabels()}});$("#slider-color").slider({value:51-COLOR_TWEEN_INTERVAL,min:1,max:50,step:1,
slide:function(a,b){COLOR_TWEEN_INTERVAL=51-b.value;updateColor();updateSettingsLabels()}});$("#slider-hue").slider({value:COLOR_HUE_INCREMENT,min:1,max:180,step:1,slide:function(a,b){COLOR_HUE_INCREMENT=b.value;updateColor();updateSettingsLabels()}});updateSettingsLabels()}}function doit(){clearInterval(intervalID)}
function toggleFooter(){var a=$("#footer");if(a.is(":visible")){a.slideUp();localStorage.setItem("header-visible","false")}else{a.slideDown();localStorage.setItem("header-visible","true")}}function resize(){canvas.width=canvasWidth=$(window).width();canvas.height=canvasHeight=$(window).height();resizeWindows()}
function resizeWindows(){var a=$("#screen"),b=$("#about"),c=$("#settings");b.css("left",(a.outerWidth()-b.outerWidth())/2);b.css("top",(a.outerHeight()-b.outerHeight())/2);c.css("left",(a.outerWidth()-c.outerWidth())/2);c.css("top",(a.outerHeight()-c.outerHeight())/2)}function init(){$("#canvas").click(function(){toggleFooter()});window.localStorage.getItem("header-visible")==="true"&&$("#footer").show();start()}
function start(){curPointListIndex=0;pointLists=[];numSteps=0;polygonsList=[];$(window).resize(resize);renderStep=false;initInterval();canvas=document.getElementById("canvas");context=canvas.getContext("2d");resize();canvasWidth=canvas.width;canvasHeight=canvas.height;for(var a=0;a<NUM_POLYGONS;a++)polygonsList.push(new Polygon(canvasWidth,canvasHeight,NUM_TRAILS,NUM_POINTS,SATURATION,BRIGHTNESS,COLOR_TWEEN_INTERVAL,COLOR_HUE_INCREMENT));step()}
function initInterval(){intervalID!=-1&&clearInterval(intervalID);intervalID=setInterval(step,INTERVAL_TIME/2)}function updateColor(){for(var a=0;a<NUM_POLYGONS;a++)polygonsList[a].setColorOptions(SATURATION,BRIGHTNESS,COLOR_TWEEN_INTERVAL,COLOR_HUE_INCREMENT)}
function updateSettingsLabels(){$("#slider-redraw-val").html(INTERVAL_TIME+" ms");$("#slider-shapes-val").html(NUM_POLYGONS);$("#slider-trails-val").html(NUM_TRAILS);$("#slider-lines-val").html(NUM_POINTS);$("#slider-sat-val").html(SATURATION+"%");$("#slider-bright-val").html(BRIGHTNESS+"%");$("#slider-color-val").html("every "+COLOR_TWEEN_INTERVAL+" frame"+(COLOR_TWEEN_INTERVAL==1?"":"s"));$("#slider-hue-val").html(COLOR_HUE_INCREMENT+" degrees")}
function step(){if(renderStep){context.clearRect(0,0,canvasWidth,canvasHeight);canvas.width=canvasWidth;for(var a=0;a<NUM_POLYGONS;a++)polygonsList[a].render(context)}else for(a=0;a<NUM_POLYGONS;a++)polygonsList[a].update();renderStep=!renderStep};