function Polygon(a,b,c,d,e,f,g,h){this._canvasWidth=a;this._canvasHeight=b;this._curHue=this.getRand(360);this.setColorOptions(e,f,g,h);this._numTrails=c;this._numPoints=d;this._curPointListIndex=0;this._pointList=this.makePointList();this._trailsList=[];this._context=null;for(b=0;b<this._numTrails;b++){a=[];this.copyPointList(this._pointList,a);this._trailsList.push(a)}}
Polygon.prototype.setColorOptions=function(a,b,c,d){this._saturation=a;this._brightness=b;this._colorTweenInterval=c;this._curColorTweenInterval=0;this._colorHueIncrement=d;this.seedHue()};Polygon.prototype.seedHue=function(){this._targetHue=this.getRand(360);this._hueDirection=this.getRand(1)==0?-1:1};
Polygon.prototype.update=function(){this._curColorTweenInterval=(this._curColorTweenInterval+1)%this._colorTweenInterval;if(this._curColorTweenInterval==0){if(this._curHue==this._targetHue)this.seedHue();else this._curHue+=this._hueDirection*this._colorHueIncrement;if(this._curHue>360)this._curHue-=360;if(this._curHue<0)this._curHue+=360}if(this._trailsList.length>0){this.overwritePointList(this._pointList,this._trailsList[this._curPointListIndex]);this._curPointListIndex=(this._curPointListIndex+
1)%this._numTrails}this.updatePointList()};Polygon.prototype.render=function(a){this._context=a;a=this.getColorString();this.renderPointList(this._pointList,a,1);for(var b=0;b<this._numTrails;b++)this.renderPointList(this._trailsList[b],a,1)};Polygon.prototype.getColorString=function(){return"hsl("+this._curHue+", "+this._saturation+"%, "+this._brightness+"%)"};Polygon.prototype.getRand=function(a){return Math.floor(Math.random()*a)};
Polygon.prototype.makePointList=function(){for(var a=[],b=0;b<this._numPoints;b++)a.push(this.makePoint(this.getRand(this._canvasWidth),this.getRand(this._canvasHeight),10,this.getRand(2*Math.PI)));return a};Polygon.prototype.makePoint=function(a,b,c,d){return{x:a,y:b,xSpeed:Math.cos(d)*c,ySpeed:Math.sin(d)*c,totalSpeed:c}};
Polygon.prototype.updatePoint=function(a,b){a.x=b.x+b.xSpeed;a.y=b.y+b.ySpeed;a.xSpeed=b.xSpeed;a.ySpeed=b.ySpeed;a.speed=b.totalSpeed;var c=false;if(a.x<0){c=true;a.xSpeed*=-1;a.x=0}else if(a.x>canvasWidth){c=true;a.xSpeed*=-1;a.x=canvasWidth}if(a.y<0){c=true;a.ySpeed*=-1;a.y=0}else if(a.y>canvasHeight){c=true;a.ySpeed*=-1;a.y=canvasHeight}if(c){c=this.getRand(13)+3;a.xSpeed=c*a.xSpeed/a.totalSpeed;a.ySpeed=c*a.ySpeed/a.totalSpeed;a.totalSpeed=c}};
Polygon.prototype.updatePointList=function(){for(var a=0;a<this._numPoints;a++)this.updatePoint(this._pointList[a],this._pointList[a])};Polygon.prototype.copyPointList=function(a,b){for(var c=a.length,d=0;d<c;d++)b.push(this.copyPoint(a[d]))};Polygon.prototype.overwritePointList=function(a,b){for(var c=a.length,d=0;d<c;d++)this.overwritePoint(a[d],b[d])};Polygon.prototype.overwritePoint=function(a,b){b.x=a.x;b.y=a.y};
Polygon.prototype.copyPoint=function(a){var b=this.makePoint(0,0,0,0);b.x=a.x;b.y=a.y;b.xSpeed=a.xSpeed;b.ySpeed=a.ySpeed;b.totalSpeed=a.totalSpeed;return b};Polygon.prototype.renderPointList=function(a,b,c){if(a.length>0){this._context.beginPath();for(var d=0;d<this._numPoints;d++)this.renderLine(a[d],a[(d+1)%this._numPoints]);this._context.strokeStyle=b;this._context.lineWidth=c;this._context.lineCap="round";this._context.closePath();this._context.stroke()}};
Polygon.prototype.renderLine=function(a,b){this._context.moveTo(a.x,a.y);this._context.lineTo(b.x,b.y)};